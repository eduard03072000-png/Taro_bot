"""
–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ù—É–º–µ—Ä–æ–ª–æ–≥–∏–∏
–ü–æ–ª–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –∏–º–µ–Ω–∏, –¥–∞—Ç–µ, –≤—Ä–µ–º–µ–Ω–∏ –∏ –º–µ—Å—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è
"""
from datetime import datetime
from typing import Dict, List

class NumerologyExtended:
    def __init__(self):
        self.letter_values = self._create_letter_map()
        self.master_numbers = [11, 22, 33]
    
    def _create_letter_map(self) -> Dict[str, int]:
        """–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä"""
        ru_letters = {
            '–∞': 1, '–±': 2, '–≤': 3, '–≥': 4, '–¥': 5, '–µ': 6, '—ë': 6,
            '–∂': 7, '–∑': 8, '–∏': 9, '–π': 1, '–∫': 2, '–ª': 3, '–º': 4,
            '–Ω': 5, '–æ': 6, '–ø': 7, '—Ä': 8, '—Å': 9, '—Ç': 1, '—É': 2,
            '—Ñ': 3, '—Ö': 4, '—Ü': 5, '—á': 6, '—à': 7, '—â': 8, '—ä': 9,
            '—ã': 1, '—å': 2, '—ç': 3, '—é': 4, '—è': 5
        }
        return ru_letters
    
    def _reduce_to_single(self, number: int, allow_master: bool = True) -> int:
        """–ü—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É —á–∏—Å–ª—É (–∏–ª–∏ –º–∞—Å—Ç–µ—Ä-—á–∏—Å–ª—É)"""
        if allow_master and number in self.master_numbers:
            return number
        
        while number > 9:
            number = sum(int(d) for d in str(number))
            if allow_master and number in self.master_numbers:
                return number
        
        return number
    
    def calculate_life_path(self, birth_date: str) -> Dict:
        """
        –ß–∏—Å–ª–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ü—É—Ç–∏ - —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ —á–∏—Å–ª–æ
        Args: birth_date –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD.MM.YYYY
        """
        try:
            day, month, year = map(int, birth_date.split('.'))
        except:
            return {'error': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã'}
        
        # –°—á–∏—Ç–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
        day_sum = self._reduce_to_single(day)
        month_sum = self._reduce_to_single(month)
        year_sum = self._reduce_to_single(year)
        
        # –ò—Ç–æ–≥–æ–≤–æ–µ —á–∏—Å–ª–æ
        total = day_sum + month_sum + year_sum
        life_path = self._reduce_to_single(total)
        
        meanings = {
            1: {
                'name': '–õ–∏–¥–µ—Ä',
                'description': '–ü–µ—Ä–≤–æ–ø—Ä–æ—Ö–æ–¥–µ—Ü, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –∞–º–±–∏—Ü–∏–∏',
                'traits': '–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å',
                'challenges': '–≠–≥–æ–∏–∑–º, —É–ø—Ä—è–º—Å—Ç–≤–æ, –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å',
                'career': '–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å, —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å, –Ω–æ–≤–∞—Ç–æ—Ä'
            },
            2: {
                'name': '–î–∏–ø–ª–æ–º–∞—Ç',
                'description': '–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, –≥–∞—Ä–º–æ–Ω–∏—è, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
                'traits': '–¢–µ—Ä–ø–µ–Ω–∏–µ, –¥–∏–ø–ª–æ–º–∞—Ç–∏—è, –∏–Ω—Ç—É–∏—Ü–∏—è',
                'challenges': '–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –Ω–µ—Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–±–∏–¥—á–∏–≤–æ—Å—Ç—å',
                'career': '–ü—Å–∏—Ö–æ–ª–æ–≥, –º–µ–¥–∏–∞—Ç–æ—Ä, —Ö—É–¥–æ–∂–Ω–∏–∫'
            },
            3: {
                'name': '–¢–≤–æ—Ä–µ—Ü',
                'description': '–°–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–º, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è',
                'traits': '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —ç–Ω—Ç—É–∑–∏–∞–∑–º',
                'challenges': '–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ—Å—Ç—å, —Ä–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å',
                'career': '–ê—Ä—Ç–∏—Å—Ç, –ø–∏—Å–∞—Ç–µ–ª—å, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å'
            },
            4: {
                'name': '–°—Ç—Ä–æ–∏—Ç–µ–ª—å',
                'description': '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –ø–æ—Ä—è–¥–æ–∫, –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å',
                'traits': '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, —Ç—Ä—É–¥–æ–ª—é–±–∏–µ',
                'challenges': '–†–∏–≥–∏–¥–Ω–æ—Å—Ç—å, —É–ø—Ä—è–º—Å—Ç–≤–æ, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ—Å—Ç—å',
                'career': '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, –±—É—Ö–≥–∞–ª—Ç–µ—Ä, –∏–Ω–∂–µ–Ω–µ—Ä'
            },
            5: {
                'name': '–°–≤–æ–±–æ–¥–Ω—ã–π –¥—É—Ö',
                'description': '–°–≤–æ–±–æ–¥–∞, –ø–µ—Ä–µ–º–µ–Ω—ã, –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è',
                'traits': '–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å, –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —ç–Ω–µ—Ä–≥–∏—á–Ω–æ—Å—Ç—å',
                'challenges': '–ù–µ–ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ, –±–µ–∑–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
                'career': '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç, –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫, –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥'
            },
            6: {
                'name': '–í–æ—Å–ø–∏—Ç–∞—Ç–µ–ª—å',
                'description': '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –∑–∞–±–æ—Ç–∞, —Å–ª—É–∂–µ–Ω–∏–µ',
                'traits': '–ó–∞–±–æ—Ç–∞, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –≥–∞—Ä–º–æ–Ω–∏—è',
                'challenges': '–ù–∞–≤—è–∑—á–∏–≤–æ—Å—Ç—å, –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
                'career': '–£—á–∏—Ç–µ–ª—å, –≤—Ä–∞—á, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—Ç–Ω–∏–∫'
            },
            7: {
                'name': '–ú—ã—Å–ª–∏—Ç–µ–ª—å',
                'description': '–ê–Ω–∞–ª–∏–∑, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å, –º—É–¥—Ä–æ—Å—Ç—å',
                'traits': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —É–º, –∏–Ω—Ç—É–∏—Ü–∏—è, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å',
                'challenges': '–ò–∑–æ–ª—è—Ü–∏—è, –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
                'career': '–£—á–µ–Ω—ã–π, —Ñ–∏–ª–æ—Å–æ—Ñ, –∞–Ω–∞–ª–∏—Ç–∏–∫'
            },
            8: {
                'name': '–ú–∞–≥–Ω–∞—Ç',
                'description': '–í–ª–∞—Å—Ç—å, —É—Å–ø–µ—Ö, –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ –∏–∑–æ–±–∏–ª–∏–µ',
                'traits': '–ê–º–±–∏—Ü–∏–æ–∑–Ω–æ—Å—Ç—å, –≤–ª–∞—Å—Ç—å, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏',
                'challenges': '–ñ–∞–¥–Ω–æ—Å—Ç—å, –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏, —Ç—Ä—É–¥–æ–≥–æ–ª–∏–∑–º',
                'career': '–ë–∏–∑–Ω–µ—Å–º–µ–Ω, —Ñ–∏–Ω–∞–Ω—Å–∏—Å—Ç, –ø–æ–ª–∏—Ç–∏–∫'
            },
            9: {
                'name': '–ì—É–º–∞–Ω–∏—Å—Ç',
                'description': '–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, —Å–ª—É–∂–µ–Ω–∏–µ –º–∏—Ä—É',
                'traits': '–°–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, –º—É–¥—Ä–æ—Å—Ç—å, –∏–¥–µ–∞–ª–∏–∑–º',
                'challenges': '–ú—É—á–µ–Ω–∏—á–µ—Å—Ç–≤–æ, –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å',
                'career': '–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å, –ø—Å–∏—Ö–æ–ª–æ–≥, —Ü–µ–ª–∏—Ç–µ–ª—å'
            },
            11: {
                'name': '–î—É—Ö–æ–≤–Ω—ã–π –ø–æ—Å–ª–∞–Ω–Ω–∏–∫',
                'description': '–í—ã—Å–æ–∫–∞—è –∏–Ω—Ç—É–∏—Ü–∏—è, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –ø—Ä–æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ',
                'traits': '–ò–Ω—Ç—É–∏—Ü–∏—è, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å',
                'challenges': '–ù–µ—Ä–≤–æ–∑–Ω–æ—Å—Ç—å, –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å, —Ñ–∞–Ω–∞—Ç–∏–∑–º',
                'career': '–¶–µ–ª–∏—Ç–µ–ª—å, —É—á–∏—Ç–µ–ª—å, –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç'
            },
            22: {
                'name': '–ú–∞—Å—Ç–µ—Ä-—Å—Ç—Ä–æ–∏—Ç–µ–ª—å',
                'description': '–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤',
                'traits': '–í–∏–¥–µ–Ω–∏–µ, –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å, –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ',
                'challenges': '–°—Ç—Ä–µ—Å—Å, –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º, –¥–∞–≤–ª–µ–Ω–∏–µ',
                'career': '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, –¥–∏–ø–ª–æ–º–∞—Ç, —Ä–µ—Ñ–æ—Ä–º–∞—Ç–æ—Ä'
            },
            33: {
                'name': '–ú–∞—Å—Ç–µ—Ä-—É—á–∏—Ç–µ–ª—å',
                'description': '–ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è –ª—é–±–æ–≤—å, —Å–ª—É–∂–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤—É',
                'traits': '–ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è –ª—é–±–æ–≤—å, –º—É–¥—Ä–æ—Å—Ç—å, —Å–ª—É–∂–µ–Ω–∏–µ',
                'challenges': '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞, –∂–µ—Ä—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
                'career': '–î—É—Ö–æ–≤–Ω—ã–π —É—á–∏—Ç–µ–ª—å, —Ü–µ–ª–∏—Ç–µ–ª—å, –≥—É–º–∞–Ω–∏—Ç–∞—Ä–∏–π'
            }
        }
        
        return {
            'number': life_path,
            'meaning': meanings.get(life_path, meanings[1])
        }
    
    def calculate_destiny_number(self, full_name: str) -> Dict:
        """
        –ß–∏—Å–ª–æ –°—É–¥—å–±—ã (–í—ã—Ä–∞–∂–µ–Ω–∏—è) - –ø–æ –ø–æ–ª–Ω–æ–º—É –∏–º–µ–Ω–∏
        """
        total = 0
        name = full_name.lower().replace(' ', '')
        
        for char in name:
            if char in self.letter_values:
                total += self.letter_values[char]
        
        destiny_num = self._reduce_to_single(total)
        
        descriptions = {
            1: '–õ–∏–¥–µ—Ä—Å—Ç–≤–æ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å - –≤–∞—à –ø—É—Ç—å –∫ —É—Å–ø–µ—Ö—É',
            2: '–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ - –≤–∞—à–µ –ø—Ä–∏–∑–≤–∞–Ω–∏–µ',
            3: '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ - –≤–∞—à –¥–∞—Ä –º–∏—Ä—É',
            4: '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ—Ä—è–¥–æ–∫ - –≤–∞—à –≤–∫–ª–∞–¥',
            5: '–°–≤–æ–±–æ–¥–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è - –≤–∞—à–∞ –º–∏—Å—Å–∏—è',
            6: '–°–ª—É–∂–µ–Ω–∏–µ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å - –≤–∞—à–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ',
            7: '–ó–Ω–∞–Ω–∏–µ –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å - –≤–∞—à –ø—É—Ç—å',
            8: '–í–ª–∞—Å—Ç—å –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π —É—Å–ø–µ—Ö - –≤–∞—à–∞ —Ü–µ–ª—å',
            9: '–ì—É–º–∞–Ω–∏–∑–º –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ - –≤–∞—à–∞ —Ä–æ–ª—å',
            11: '–î—É—Ö–æ–≤–Ω–æ–µ –ø—Ä–æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ - –≤—ã—Å—à–∞—è –º–∏—Å—Å–∏—è',
            22: '–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ - –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è –º–∏—Å—Å–∏—è',
            33: '–ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è –ª—é–±–æ–≤—å –∏ —É—á–∏—Ç–µ–ª—å—Å—Ç–≤–æ'
        }
        
        return {
            'number': destiny_num,
            'description': descriptions.get(destiny_num, descriptions[1])
        }
    
    def calculate_soul_number(self, full_name: str) -> Dict:
        """
        –ß–∏—Å–ª–æ –î—É—à–∏ - –∂–µ–ª–∞–Ω–∏—è —Å–µ—Ä–¥—Ü–∞ (–ø–æ –≥–ª–∞—Å–Ω—ã–º)
        """
        vowels = '–∞–µ—ë–∏–æ—É—ã—ç—é—è'
        total = 0
        
        name = full_name.lower().replace(' ', '')
        for char in name:
            if char in vowels and char in self.letter_values:
                total += self.letter_values[char]
        
        soul_num = self._reduce_to_single(total)
        
        meanings = {
            1: '–ñ–µ–ª–∞–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ª–∏–¥–µ—Ä—Å—Ç–≤–∞',
            2: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ –≥–∞—Ä–º–æ–Ω–∏–∏ –∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤—É',
            3: '–ñ–∞–∂–¥–∞ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞',
            4: '–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
            5: '–ñ–µ–ª–∞–Ω–∏–µ —Å–≤–æ–±–æ–¥—ã –∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π',
            6: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –∏ —Å–ª—É–∂–∏—Ç—å',
            7: '–ü–æ–∏—Å–∫ –∑–Ω–∞–Ω–∏–π –∏ –¥—É—Ö–æ–≤–Ω–æ—Å—Ç–∏',
            8: '–ñ–µ–ª–∞–Ω–∏–µ –≤–ª–∞—Å—Ç–∏ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ —É—Å–ø–µ—Ö–∞',
            9: '–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞—Ç—å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤—É'
        }
        
        return {
            'number': soul_num,
            'meaning': meanings.get(soul_num, meanings[1])
        }
    
    def calculate_personality_number(self, full_name: str) -> Dict:
        """
        –ß–∏—Å–ª–æ –õ–∏—á–Ω–æ—Å—Ç–∏ - –∫–∞–∫ –≤–∞—Å –≤–∏–¥—è—Ç –¥—Ä—É–≥–∏–µ (–ø–æ —Å–æ–≥–ª–∞—Å–Ω—ã–º)
        """
        consonants = set('–±–≤–≥–¥–∂–∑–∫–ª–º–Ω–ø—Ä—Å—Ç—Ñ—Ö—Ü—á—à—â—ä—å')
        total = 0
        
        name = full_name.lower().replace(' ', '')
        for char in name:
            if char in consonants and char in self.letter_values:
                total += self.letter_values[char]
        
        personality_num = self._reduce_to_single(total)
        
        return {
            'number': personality_num,
            'description': f'–û–∫—Ä—É–∂–∞—é—â–∏–µ –≤–∏–¥—è—Ç –≤ –≤–∞—Å —ç–Ω–µ—Ä–≥–∏—é —á–∏—Å–ª–∞ {personality_num}'
        }
    
    def calculate_personal_year(self, birth_date: str, year: int = 2026) -> Dict:
        """
        –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–¥ - —ç–Ω–µ—Ä–≥–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
        """
        try:
            day, month, _ = map(int, birth_date.split('.'))
        except:
            return {'error': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã'}
        
        total = day + month + year
        personal_year = self._reduce_to_single(total)
        
        year_meanings = {
            1: {
                'theme': '–ù–æ–≤—ã–µ –Ω–∞—á–∏–Ω–∞–Ω–∏—è',
                'description': '–ì–æ–¥ –¥–ª—è –Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏',
                'advice': '–ë–µ—Ä–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É, –±—É–¥—å—Ç–µ —Å–º–µ–ª—ã–º–∏'
            },
            2: {
                'theme': '–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ',
                'description': '–ì–æ–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞, —Ç–µ—Ä–ø–µ–Ω–∏—è, –æ—Ç–Ω–æ—à–µ–Ω–∏–π',
                'advice': '–†–∞–±–æ—Ç–∞–π—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ, —Ä–∞–∑–≤–∏–≤–∞–π—Ç–µ –¥–∏–ø–ª–æ–º–∞—Ç–∏—é'
            },
            3: {
                'theme': '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ',
                'description': '–ì–æ–¥ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–¥–æ—Å—Ç–∏, –æ–±—â–µ–Ω–∏—è',
                'advice': '–í—ã—Ä–∞–∂–∞–π—Ç–µ —Å–µ–±—è, –æ–±—â–∞–π—Ç–µ—Å—å, —Ç–≤–æ—Ä–∏—Ç–µ'
            },
            4: {
                'theme': '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å',
                'description': '–ì–æ–¥ —É–ø–æ—Ä–Ω–æ–≥–æ —Ç—Ä—É–¥–∞, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞',
                'advice': '–†–∞–±–æ—Ç–∞–π—Ç–µ —É—Å–µ—Ä–¥–Ω–æ, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Å–Ω–æ–≤—É'
            },
            5: {
                'theme': '–ü–µ—Ä–µ–º–µ–Ω—ã',
                'description': '–ì–æ–¥ —Å–≤–æ–±–æ–¥—ã, –∏–∑–º–µ–Ω–µ–Ω–∏–π, –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π',
                'advice': '–ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω—ã, –±—É–¥—å—Ç–µ –≥–∏–±–∫–∏–º–∏'
            },
            6: {
                'theme': '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
                'description': '–ì–æ–¥ —Å–µ–º—å–∏, –¥–æ–º–∞, —Å–ª—É–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏–º',
                'advice': '–ó–∞–±–æ—Ç—å—Ç–µ—Å—å –æ –±–ª–∏–∑–∫–∏—Ö, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–∞—Ä–º–æ–Ω–∏—é'
            },
            7: {
                'theme': '–î—É—Ö–æ–≤–Ω–æ—Å—Ç—å',
                'description': '–ì–æ–¥ —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—è, —É—á–µ–±—ã, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–æ—Å—Ç–∞',
                'advice': '–£—á–∏—Ç–µ—Å—å, –º–µ–¥–∏—Ç–∏—Ä—É–π—Ç–µ, –∏—â–∏—Ç–µ –∏—Å—Ç–∏–Ω—É'
            },
            8: {
                'theme': '–í–ª–∞—Å—Ç—å –∏ –¥–µ–Ω—å–≥–∏',
                'description': '–ì–æ–¥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, —É—Å–ø–µ—Ö–∞, –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –∏–∑–æ–±–∏–ª–∏—è',
                'advice': '–°—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ —É—Å–ø–µ—Ö—É, –ø—Ä–æ—è–≤–ª—è–π—Ç–µ –∞–º–±–∏—Ü–∏–∏'
            },
            9: {
                'theme': '–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ',
                'description': '–ì–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–æ–≤, –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è, –≥—É–º–∞–Ω–∏–∑–º–∞',
                'advice': '–û—Ç–ø—É—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä–æ–µ, –ø–æ–º–æ–≥–∞–π—Ç–µ –¥—Ä—É–≥–∏–º'
            }
        }
        
        return {
            'year': year,
            'number': personal_year,
            'info': year_meanings.get(personal_year, year_meanings[1])
        }
    
    def calculate_pythagoras_square(self, birth_date: str) -> Dict:
        """
        –ö–≤–∞–¥—Ä–∞—Ç –ü–∏—Ñ–∞–≥–æ—Ä–∞ - –ø—Å–∏—Ö–æ–º–∞—Ç—Ä–∏—Ü–∞
        """
        try:
            date_digits = birth_date.replace('.', '')
            digits = [int(d) for d in date_digits]
        except:
            return {'error': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã'}
        
        # –ü–æ–¥—Å—á–µ—Ç –∫–∞–∂–¥–æ–π —Ü–∏—Ñ—Ä—ã
        counts = {i: digits.count(i) for i in range(1, 10)}
        
        lines = {
            'character': counts[1],  # –•–∞—Ä–∞–∫—Ç–µ—Ä
            'energy': counts[2],      # –≠–Ω–µ—Ä–≥–∏—è
            'interest': counts[3],    # –ò–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–∞—É–∫–∞–º
            'health': counts[4],      # –ó–¥–æ—Ä–æ–≤—å–µ
            'logic': counts[5],       # –õ–æ–≥–∏–∫–∞
            'labor': counts[6],       # –¢—Ä—É–¥–æ–ª—é–±–∏–µ
            'luck': counts[7],        # –£–¥–∞—á–∞
            'duty': counts[8],        # –î–æ–ª–≥
            'memory': counts[9]       # –ü–∞–º—è—Ç—å
        }
        
        return {
            'matrix': counts,
            'qualities': lines
        }
    
    def full_numerology_report(self, full_name: str, birth_date: str) -> str:
        """–ü–æ–ª–Ω—ã–π –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç"""
        result = "üî¢ **–ü–û–õ–ù–´–ô –ù–£–ú–ï–†–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó**\n\n"
        
        # –ß–∏—Å–ª–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ü—É—Ç–∏
        life_path = self.calculate_life_path(birth_date)
        if 'error' not in life_path:
            result += f"üåü **–ß–∏—Å–ª–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ü—É—Ç–∏: {life_path['number']}**\n"
            result += f"–ê—Ä—Ö–µ—Ç–∏–ø: {life_path['meaning']['name']}\n"
            result += f"{life_path['meaning']['description']}\n"
            result += f"‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: {life_path['meaning']['traits']}\n"
            result += f"‚ö†Ô∏è –í—ã–∑–æ–≤—ã: {life_path['meaning']['challenges']}\n"
            result += f"üíº –ö–∞—Ä—å–µ—Ä–∞: {life_path['meaning']['career']}\n\n"
        
        # –ß–∏—Å–ª–æ –°—É–¥—å–±—ã
        destiny = self.calculate_destiny_number(full_name)
        result += f"üéØ **–ß–∏—Å–ª–æ –°—É–¥—å–±—ã: {destiny['number']}**\n"
        result += f"{destiny['description']}\n\n"
        
        # –ß–∏—Å–ª–æ –î—É—à–∏
        soul = self.calculate_soul_number(full_name)
        result += f"üíñ **–ß–∏—Å–ª–æ –î—É—à–∏: {soul['number']}**\n"
        result += f"{soul['meaning']}\n\n"
        
        # –ß–∏—Å–ª–æ –õ–∏—á–Ω–æ—Å—Ç–∏
        personality = self.calculate_personality_number(full_name)
        result += f"üë§ **–ß–∏—Å–ª–æ –õ–∏—á–Ω–æ—Å—Ç–∏: {personality['number']}**\n"
        result += f"{personality['description']}\n\n"
        
        # –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–¥
        personal_year = self.calculate_personal_year(birth_date)
        if 'error' not in personal_year:
            result += f"üìÖ **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–¥ {personal_year['year']}: {personal_year['number']}**\n"
            result += f"–¢–µ–º–∞: {personal_year['info']['theme']}\n"
            result += f"{personal_year['info']['description']}\n"
            result += f"üí° –°–æ–≤–µ—Ç: {personal_year['info']['advice']}\n"
        
        return result

    # ============= –û–ë–Å–†–¢–ö–ê –î–õ–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–ò –° BOT.PY =============
    def full_report(self, birth_date: str, full_name: str, 
                    birth_time: str = None, birth_place: str = None) -> str:
        """
        –û–±—ë—Ä—Ç–∫–∞ –¥–ª—è –º–µ—Ç–æ–¥–∞ full_numerology_report –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å bot.py
        Args:
            birth_date: –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD.MM.YYYY
            full_name: –ø–æ–ª–Ω–æ–µ –∏–º—è (–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ)
            birth_time: –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
            birth_place: –º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
        Returns:
            –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ä–∞—Å—á—ë—Ç–∞
        """
        return self.full_numerology_report(full_name, birth_date)
